# 01 需求分析

## 一、项目背景与概述

随着智能驾驶与辅助驾驶技术的迅猛发展，车道偏离预警（LDWS: Lane Departure Warning System）已成为基础的主动安全辅助功能之一。该系统通过图像识别技术，实时分析道路画面中的车道线位置，判断车辆是否发生非主动偏离车道行为，并进行声光等提示，帮助驾驶者纠正偏离。

本项目旨在基于国产飞腾派嵌入式平台，构建一个轻量级、实时、稳定运行的车道偏离预警系统，采用经典图像处理算法（如 Sobel 边缘检测、Hough 直线变换）完成车道检测与偏移计算，实现警告提示输出，具备低功耗、高效率、易部署等特性。

---

## 二、项目目标

- 搭建基于飞腾派开发板的嵌入式图像处理系统；
- 实现实时视频帧采集、图像处理、车道线提取与偏离分析；
- 输出偏离方向并实现预警提示（LED、串口等）；
- 支持在低照度与复杂路况下保持检测精度；
- 系统结构清晰、可扩展、运行稳定。

---

## 三、系统功能需求

### 3.1 核心功能点

| 编号 | 功能名称            | 描述                                             |
| ---- | ------------------- | ------------------------------------------------ |
| F1   | 摄像头图像采集      | 通过 USB 接口获取视频帧，支持 720p 或 1080p      |
| F2   | 多帧图像融合        | 对连续图像帧进行融合以提升低照度条件下的图像质量 |
| F3   | 边缘检测（Sobel）   | 提取图像中明显边缘信息以辅助直线检测             |
| F4   | 车道线检测（Hough） | 使用 HoughLinesP 提取图像中的直线车道线          |
| F5   | 偏移量计算          | 判断车辆中心与车道中心的相对偏移                 |
| F6   | 预警提示输出        | 根据偏移量大小和方向控制 LED 灯/串口输出偏离状态 |

---

### 3.2 可选增强功能（后期拓展）

- F7：图像输出叠加检测结果用于调试或展示；
- F8：预警日志记录与偏移数据保存；
- F9：通过配置文件调整阈值和运行参数；
- F10：提供 HTTP/串口服务接口，支持上层系统集成。

---

## 四、性能需求

| 编号 | 性能指标     | 目标要求                   |
| ---- | ------------ | -------------------------- |
| P1   | 帧率         | 实时处理 ≥ 10 FPS          |
| P2   | 响应延迟     | 从帧采集到偏移判断 ≤ 100ms |
| P3   | CPU 占用率   | ≤ 80%，支持多核优化        |
| P4   | 内存占用     | ≤ 200MB（含图像缓存）      |
| P5   | 稳定运行时长 | 连续 30min 运行无崩溃/异常 |

---

## 五、非功能性需求

### 5.1 系统稳定性
- 系统应能长期稳定运行，不崩溃、不死机；
- 应具备断电重启、摄像头意外断开后的恢复机制。

### 5.2 易用性
- 提供启动脚本，简化部署操作；
- 关键运行信息应通过终端日志输出，便于调试；
- 输出图像可选保存中间结果（如边缘图、车道线图）。

### 5.3 可配置性
- 偏移量阈值、图像分辨率、融合帧数应支持通过配置文件设置；
- 支持调试模式与运行模式切换。

### 5.4 可维护性与扩展性
- 项目结构应遵循模块化开发原则，方便替换图像处理模块；
- 每个功能模块具备明确边界和接口，便于后期升级；
- 日志模块、调试工具可独立扩展。

---

## 六、系统边界与约束条件

### 6.1 输入定义

| 输入来源 | 类型     | 描述                    |
| -------- | -------- | ----------------------- |
| 摄像头   | 视频帧流 | 通过 USB 接口获取图像流 |
| 配置文件 | 参数集合 | 启动参数、阈值设置等    |

### 6.2 输出定义

| 输出形式 | 内容                       |
| -------- | -------------------------- |
| 控制台   | 当前帧状态、偏移值         |
| 串口/LED | 偏移方向的警告输出         |
| 图像文件 | 边缘图、车道线图像（可选） |

### 6.3 硬件与平台约束

| 约束项     | 要求                            |
| ---------- | ------------------------------- |
| 平台       | 飞腾派开发板，ARM64 架构        |
| 系统环境   | Linux (嵌入式 Debian 或 Ubuntu) |
| 摄像头接口 | USB 2.0 或 USB 3.0              |
| 编程语言   | C/C++，图像处理可用 OpenCV      |
| 禁用项     | 禁止使用云端推理或深度模型依赖  |

---

## 七、初步项目工作流程图

```text
[ 摄像头采集 ]
        ↓
[ 多帧图像融合 ]
        ↓
[ Sobel 边缘检测 ]
        ↓
[ Hough 直线检测 ]
        ↓
[ 偏移判断 ]
        ↓
[ 输出预警 ]
```

## 八、风险与应对策略

| 风险点           | 影响       | 应对措施                     |
| ---------------- | ---------- | ---------------------------- |
| 图像质量波动大   | 检测不准确 | 使用多帧融合/中值滤波        |
| 边缘检测噪声干扰 | 虚假车道线 | 增加角度/斜率过滤规则        |
| 摄像头失联       | 系统崩溃   | 加入摄像头心跳检测与重连机制 |
| 飞腾派资源限制   | 性能不足   | 使用 NEON 优化、多线程处理   |



------

## 九、需求确认与版本管理

- 当前为项目开发初期 v1.0.0 的需求版本；
- 文档后续若有调整需提交版本更新记录，并同步至 README 与项目主干；
- 各阶段任务将参考本需求文档展开，并作为验收与测试依据。
ssfdsff